# Docker

## What is Docker?
Docker is a platform for developing, shipping, and running applications inside containers. Containers are lightweight, portable, and self-sufficient units that package an application and all its dependencies, ensuring that it runs consistently in any environment.

## Key Concepts
### Image: 
A lightweight, stand-alone, and executable software package that includes everything needed to run a piece of software, including the code, runtime, libraries, environment variables, and configuration files.
### Container:
A runnable instance of an image. Containers are isolated from each other and the host system.
### Dockerfile:
A text file with instructions on how to build a Docker image.

### Docker Hub:
A cloud-based registry service where Docker images are stored and shared.

### Installation
To install Docker, follow the official Docker installation guide for your operating system: Docker Installation

## Basic Docker Commands
docker version: Check the Docker version installed.

```
docker version
```

docker pull: Download an image from Docker Hub.

```

docker pull ubuntu

```

docker images: List all images on your local system.

```

docker images

```
docker run: Run a container from an image.

```

docker run ubuntu

```
docker ps: List running containers.

```
docker ps

```
docker ps -a: List all containers, including stopped ones.

```
docker ps -a

```
docker stop: Stop a running container.

```
docker stop <container_id>

```

docker rm: Remove a stopped container.


```

docker rm <container_id>

```
docker rmi: Remove an image.

```
docker rmi <image_id>

```

# Writing a Dockerfile
A Dockerfile is a text file that contains a series of instructions on how to build a Docker image.

## Example Dockerfile for a simple Python application:

```
# Use the official Python image from the Docker Hub
FROM python:3.8-slim-buster

# Set the working directory in the container
WORKDIR /app

# Copy the requirements.txt file to the working directory
COPY requirements.txt .

# Install any dependencies
RUN pip install --no-cache-dir -r requirements.txt

# Copy the rest of the application code to the working directory
COPY . .

# Specify the command to run the application
CMD ["python", "app.py"]


```

## Building and Running a Docker Image
### docker build: 

Build an image from a Dockerfile.

```

docker build -t my-python-app .

```

docker run:
Run a container from the built image.

```

docker run -d -p 5000:5000 my-python-app

```

## Docker Compose
Docker Compose is a tool for defining and running multi-container Docker applications. With Compose, you use a docker-compose.yml file to configure your application's services.

Example docker-compose.yml:

```

version: '3'
services:
  web:
    image: my-python-app
    build: .
    ports:
      - "5000:5000"
    volumes:
      - .:/app
    environment:
      - FLASK_ENV=development
  redis:
    image: "redis:alpine"


```

## Docker Compose Commands

docker-compose up: Build and start containers.

```
docker-compose up

```

docker-compose down: Stop and remove containers, networks, images, and volumes.

```

docker-compose down

```

docker-compose ps: List containers.

```

docker-compose ps

```
## Networking in Docker

docker network create: Create a new network.

```

docker network create my-network

```

docker network ls: List all networks.

```

docker network ls

```

docker network inspect: Inspect a network.

```

docker network inspect my-network

```
docker network connect: Connect a container to a network.

```

docker network connect my-network my-container

```

docker network disconnect: Disconnect a container from a network.

```

docker network disconnect my-network my-container

```

## Docker Volumes

Docker volumes are used to persist data generated by and used by Docker containers.

docker volume create: Create a new volume.


```
docker volume create my-volume

```

docker volume ls: List all volumes.


```
docker volume ls

```

docker volume inspect: Inspect a volume.


```
docker volume inspect my-volume

```

docker volume rm: Remove a volume.


```

docker volume rm my-volume

```


# My own Docker File

```

FROM node:14

# Create app directory
WORKDIR /usr/src/app

# Copy package.json and install dependencies
COPY package*.json ./
RUN npm install

# Copy app source code
COPY . .

# Expose the port
EXPOSE 3000

# Start the backend service
CMD ["node", "backend.js"]


```

## Lets Explain this Docker File 
Break it in step by step

```

FROM node:14

```
Explanation: This line specifies the base image for the Docker image. node:14 refers to the official Node.js Docker image with version 14. The base image includes Node.js and npm (Node Package Manager) pre-installed, which are necessary for running a Node.js application.


```


WORKDIR /usr/src/app

```
Explanation: This line sets the working directory inside the container to /usr/src/app. All subsequent COPY, RUN, and other commands will be executed relative to this directory. If the directory does not exist, it will be created automatically.

```


COPY package*.json ./

```

Explanation: This line copies the package.json and package-lock.json files from the host machine to the working directory inside the container. The package*.json pattern ensures both files are copied, if present. These files contain the metadata and dependencies of the Node.js application.


```

RUN npm install

```

Explanation: This line runs the npm install command inside the container, which installs the dependencies listed in the package.json file. By copying only the package.json files before running npm install, Docker can cache this step and reuse the layer if the package.json files haven't changed, speeding up subsequent builds.

```


COPY . .

```
Explanation: This line copies the rest of the application's source code from the host machine to the working directory inside the container (/usr/src/app). This includes all the application's files and directories.

```

EXPOSE 3000

```

Explanation: This line informs Docker that the container will listen on port 3000 at runtime. It does not actually publish the port; it serves as documentation and can be used by orchestration tools to configure network routing.


```

CMD ["node", "backend.js"]

```
Explanation: This line specifies the command to run when the container starts. In this case, it runs node backend.js, which starts the Node.js application. The CMD instruction should be used to provide the default command for the container. Note that CMD can be overridden when you run the container with docker run.

